{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/saalem/schedulr-ai/apps/web/app/lib/api.ts"],"sourcesContent":["import { getSession } from \"next-auth/react\";\n\nconst API_BASE = process.env.NEXT_PUBLIC_API_BASE ?? \"http://localhost:8000\";\n\n// dev-only helper: store email in localStorage\nexport function getDevEmail() {\n  if (typeof window === \"undefined\") return null;\n  return window.localStorage.getItem(\"dev_email\");\n}\n\nasync function getAuthEmail() {\n  const session = await getSession();\n  const sessionEmail = session?.user?.email ?? null;\n  if (sessionEmail) return sessionEmail;\n\n  // Only allow dev fallback in development\n  if (process.env.NODE_ENV === \"development\") {\n    return getDevEmail();\n  }\n\n  return null;\n}\n\nexport async function apiFetch(path: string, init: RequestInit = {}) {\n  const email = await getAuthEmail();\n\n  const headers = new Headers(init.headers);\n\n  // Only set content-type when we're actually sending JSON\n  const hasBody = init.body !== undefined && init.body !== null;\n  if (hasBody && !headers.has(\"Content-Type\")) {\n    headers.set(\"Content-Type\", \"application/json\");\n  }\n\n  if (email) headers.set(\"X-User-Email\", email);\n\n  const res = await fetch(`${API_BASE}${path}`, {\n    ...init,\n    headers,\n    cache: \"no-store\",\n  });\n\n  if (!res.ok) {\n    let detail = `HTTP ${res.status}`;\n    try {\n      const body = await res.json();\n      detail = body?.detail || JSON.stringify(body);\n    } catch {\n      try {\n        detail = await res.text();\n      } catch {}\n    }\n    throw new Error(detail);\n  }\n\n  return res;\n}\n"],"names":[],"mappings":";;;;;;AAEiB;AAFjB;;AAEA,MAAM,WAAW,6DAAoC;AAG9C,SAAS;IACd;;IACA,OAAO,OAAO,YAAY,CAAC,OAAO,CAAC;AACrC;AAEA,eAAe;IACb,MAAM,UAAU,MAAM,IAAA,+JAAU;IAChC,MAAM,eAAe,SAAS,MAAM,SAAS;IAC7C,IAAI,cAAc,OAAO;IAEzB,yCAAyC;IACzC,wCAA4C;QAC1C,OAAO;IACT;;;AAGF;AAEO,eAAe,SAAS,IAAY,EAAE,OAAoB,CAAC,CAAC;IACjE,MAAM,QAAQ,MAAM;IAEpB,MAAM,UAAU,IAAI,QAAQ,KAAK,OAAO;IAExC,yDAAyD;IACzD,MAAM,UAAU,KAAK,IAAI,KAAK,aAAa,KAAK,IAAI,KAAK;IACzD,IAAI,WAAW,CAAC,QAAQ,GAAG,CAAC,iBAAiB;QAC3C,QAAQ,GAAG,CAAC,gBAAgB;IAC9B;IAEA,IAAI,OAAO,QAAQ,GAAG,CAAC,gBAAgB;IAEvC,MAAM,MAAM,MAAM,MAAM,GAAG,WAAW,MAAM,EAAE;QAC5C,GAAG,IAAI;QACP;QACA,OAAO;IACT;IAEA,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,IAAI,SAAS,CAAC,KAAK,EAAE,IAAI,MAAM,EAAE;QACjC,IAAI;YACF,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,SAAS,MAAM,UAAU,KAAK,SAAS,CAAC;QAC1C,EAAE,OAAM;YACN,IAAI;gBACF,SAAS,MAAM,IAAI,IAAI;YACzB,EAAE,OAAM,CAAC;QACX;QACA,MAAM,IAAI,MAAM;IAClB;IAEA,OAAO;AACT"}},
    {"offset": {"line": 65, "column": 0}, "map": {"version":3,"sources":["file:///Users/saalem/schedulr-ai/apps/web/app/dashboard/new/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport { apiFetch } from \"../../lib/api\";\n\nexport default function NewBusiness() {\n  const router = useRouter();\n  const [name, setName] = useState(\"\");\n  const [slug, setSlug] = useState(\"\");\n  const [timezone, setTimezone] = useState(\"America/Los_Angeles\");\n  const [err, setErr] = useState<string | null>(null);\n  const [loading, setLoading] = useState(false);\n\n  function suggestSlug(v: string) {\n    return v\n      .trim()\n      .toLowerCase()\n      .replace(/[^a-z0-9\\s-]/g, \"\")\n      .replace(/\\s+/g, \"-\")\n      .replace(/-+/g, \"-\");\n  }\n\n  async function onSubmit(e: React.FormEvent) {\n    e.preventDefault();\n    setErr(null);\n    setLoading(true);\n    try {\n      const res = await apiFetch(\"/businesses\", {\n        method: \"POST\",\n        body: JSON.stringify({ name, slug, timezone }),\n      });\n      const b = await res.json();\n      router.push(`/dashboard/${b.id}`);\n    } catch (e: any) {\n      setErr(e?.message ?? \"Failed to create business\");\n      setLoading(false);\n    }\n  }\n\n  return (\n    <main style={{ padding: 24, maxWidth: 700, margin: \"0 auto\" }}>\n      <h1 style={{ fontSize: 26, fontWeight: 700 }}>Create a business</h1>\n\n      <form onSubmit={onSubmit} style={{ marginTop: 16, display: \"grid\", gap: 12 }}>\n        <label>\n          <div style={{ fontWeight: 600 }}>Business name</div>\n          <input\n            value={name}\n            onChange={(e) => {\n              setName(e.target.value);\n              if (!slug) setSlug(suggestSlug(e.target.value));\n            }}\n            style={{ width: \"100%\", padding: 10, border: \"1px solid #ccc\", borderRadius: 8 }}\n            required\n          />\n        </label>\n\n        <label>\n          <div style={{ fontWeight: 600 }}>Slug</div>\n          <input\n            value={slug}\n            onChange={(e) => setSlug(suggestSlug(e.target.value))}\n            style={{ width: \"100%\", padding: 10, border: \"1px solid #ccc\", borderRadius: 8 }}\n            required\n          />\n          <div style={{ marginTop: 6, color: \"#666\", fontSize: 13 }}>\n            Your public link will be <code>/b/{slug || \"your-slug\"}</code>\n          </div>\n        </label>\n\n        <label>\n          <div style={{ fontWeight: 600 }}>Timezone</div>\n          <input\n            value={timezone}\n            onChange={(e) => setTimezone(e.target.value)}\n            style={{ width: \"100%\", padding: 10, border: \"1px solid #ccc\", borderRadius: 8 }}\n          />\n        </label>\n\n        {err && <p style={{ color: \"crimson\" }}>{err}</p>}\n\n        <button disabled={loading} style={{ padding: \"10px 14px\", borderRadius: 8, border: \"1px solid #ccc\" }}>\n          {loading ? \"Creating...\" : \"Create business\"}\n        </button>\n      </form>\n    </main>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;;;AAJA;;;;AAMe,SAAS;;IACtB,MAAM,SAAS,IAAA,iKAAS;IACxB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,wLAAQ,EAAC;IACjC,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,wLAAQ,EAAC;IACjC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,wLAAQ,EAAC;IACzC,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,wLAAQ,EAAgB;IAC9C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,wLAAQ,EAAC;IAEvC,SAAS,YAAY,CAAS;QAC5B,OAAO,EACJ,IAAI,GACJ,WAAW,GACX,OAAO,CAAC,iBAAiB,IACzB,OAAO,CAAC,QAAQ,KAChB,OAAO,CAAC,OAAO;IACpB;IAEA,eAAe,SAAS,CAAkB;QACxC,EAAE,cAAc;QAChB,OAAO;QACP,WAAW;QACX,IAAI;YACF,MAAM,MAAM,MAAM,IAAA,+IAAQ,EAAC,eAAe;gBACxC,QAAQ;gBACR,MAAM,KAAK,SAAS,CAAC;oBAAE;oBAAM;oBAAM;gBAAS;YAC9C;YACA,MAAM,IAAI,MAAM,IAAI,IAAI;YACxB,OAAO,IAAI,CAAC,CAAC,WAAW,EAAE,EAAE,EAAE,EAAE;QAClC,EAAE,OAAO,GAAQ;YACf,OAAO,GAAG,WAAW;YACrB,WAAW;QACb;IACF;IAEA,qBACE,4MAAC;QAAK,OAAO;YAAE,SAAS;YAAI,UAAU;YAAK,QAAQ;QAAS;;0BAC1D,4MAAC;gBAAG,OAAO;oBAAE,UAAU;oBAAI,YAAY;gBAAI;0BAAG;;;;;;0BAE9C,4MAAC;gBAAK,UAAU;gBAAU,OAAO;oBAAE,WAAW;oBAAI,SAAS;oBAAQ,KAAK;gBAAG;;kCACzE,4MAAC;;0CACC,4MAAC;gCAAI,OAAO;oCAAE,YAAY;gCAAI;0CAAG;;;;;;0CACjC,4MAAC;gCACC,OAAO;gCACP,UAAU,CAAC;oCACT,QAAQ,EAAE,MAAM,CAAC,KAAK;oCACtB,IAAI,CAAC,MAAM,QAAQ,YAAY,EAAE,MAAM,CAAC,KAAK;gCAC/C;gCACA,OAAO;oCAAE,OAAO;oCAAQ,SAAS;oCAAI,QAAQ;oCAAkB,cAAc;gCAAE;gCAC/E,QAAQ;;;;;;;;;;;;kCAIZ,4MAAC;;0CACC,4MAAC;gCAAI,OAAO;oCAAE,YAAY;gCAAI;0CAAG;;;;;;0CACjC,4MAAC;gCACC,OAAO;gCACP,UAAU,CAAC,IAAM,QAAQ,YAAY,EAAE,MAAM,CAAC,KAAK;gCACnD,OAAO;oCAAE,OAAO;oCAAQ,SAAS;oCAAI,QAAQ;oCAAkB,cAAc;gCAAE;gCAC/E,QAAQ;;;;;;0CAEV,4MAAC;gCAAI,OAAO;oCAAE,WAAW;oCAAG,OAAO;oCAAQ,UAAU;gCAAG;;oCAAG;kDAChC,4MAAC;;4CAAK;4CAAI,QAAQ;;;;;;;;;;;;;;;;;;;kCAI/C,4MAAC;;0CACC,4MAAC;gCAAI,OAAO;oCAAE,YAAY;gCAAI;0CAAG;;;;;;0CACjC,4MAAC;gCACC,OAAO;gCACP,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;gCAC3C,OAAO;oCAAE,OAAO;oCAAQ,SAAS;oCAAI,QAAQ;oCAAkB,cAAc;gCAAE;;;;;;;;;;;;oBAIlF,qBAAO,4MAAC;wBAAE,OAAO;4BAAE,OAAO;wBAAU;kCAAI;;;;;;kCAEzC,4MAAC;wBAAO,UAAU;wBAAS,OAAO;4BAAE,SAAS;4BAAa,cAAc;4BAAG,QAAQ;wBAAiB;kCACjG,UAAU,gBAAgB;;;;;;;;;;;;;;;;;;AAKrC;GAlFwB;;QACP,iKAAS;;;KADF"}}]
}